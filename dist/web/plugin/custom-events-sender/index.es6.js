var sd,_,log,sdkversion_placeholder="1.27.10";function wrapPluginInitFn(n,e,r){if(e&&(n.plugin_name=e),r&&n.init){var t=n.init;n.init=function(a,i){if(wrapLogFn(a,n,e),a.readyState&&a.readyState.state>=3||!a.on)return o();function o(){t.call(n,a,i)}a.on(r,o)}}return n}function wrapLogFn(n,e,r){function t(e,t){n.logger?n.logger.msg.apply(n.logger,t).module(r+""||"").level(e).log():n.log&&n.log.apply(n,t)}e.log=function(){t("log",arguments)},e.warn=function(){t("warn",arguments)},e.error=function(){t("error",arguments)}}function createPlugin(n,e,r){return wrapPluginInitFn(n,e,r),n.plugin_version=sdkversion_placeholder,n}function flattenArray(n){var e=[];return _.each(n,function(n){_.isArray(n)?e=e.concat(flattenArray(n)):e.push(_.optimizeServerUrl(n))}),e}function hasEqualServerUrl(n,e){e=_.isArray(e)?e:[e];var r=!1;return _.isArray(n)?_.each(n,function(n){_.indexOf(e,n)>-1&&(r=!0)}):_.indexOf(e,n)>-1&&(r=!0),r}function getSendUrl(n,e){var r=sd.kit.encodeTrackData(e);return-1!==n.indexOf("?")?n+"&"+r:n+"?"+r}var sender={hookFn:null,init:function(n){this.hookFn=n,sd.registerInterceptor("sendDataStage",{send:{priority:20,entry:function(n,e){return sender.sendData(n,e),n}}})},sendData:function(n,e){var r=n.origin_data,t=r.event,a=n.server_url,i=n.callback,o=this,l=this.hookFn({event_name:t,data:_.extend2Lev({identities:{},lib:{},properties:{}},r),server_url:a});return _.isArray(l)&&l.length?(l=flattenArray(l),hasEqualServerUrl(a,l)?i=null:e.cancellationToken.stop(),_.each(l,function(e){if(e&&""!==e&&!hasEqualServerUrl(e,a)){var t=(l=e,function(){o.sendCall({server_url:l,origin_data:r,data:n.data,config:null,callback:i}),i=null,n.callback=null});setTimeout(t)}var l}),n):(_.isFunction(i)&&i(),e.cancellationToken.stop(),n)},getInstance:function(n){return"beacon"===sd.para.send_type&&_.isSupportBeaconSend()?(n.data=getSendUrl(n.server_url,n.origin_data),new _.BeaconSend(n)):"ajax"===sd.para.send_type&&_.isSupportCors()?(n.data=getSendUrl(n.server_url,n.origin_data),new _.AjaxSend(n)):(n.origin_data._flush_time=(new Date).getTime(),n.data=getSendUrl(n.server_url,n.origin_data),new _.ImageSend(n))},sendCall:function(n){this.getInstance(n).start()}},CustomEventsSender={plugin_name:"CustomEventsSender",init:function(n,e){if(_=(sd=n)._,log=sd&&sd.log||console&&console.log||function(){},_.isFunction(e)){if(sd.readyState&&sd.readyState.state>=3||!sd.on)return sender.init(e);sd.on("sdkAfterInitPara",function(){sender.init(e)})}else log("CustomEventsSender init failed\uff0chookFn error. hookFn:",e)}},index=createPlugin(CustomEventsSender);export default index;